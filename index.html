<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Cool Website with Vega Charts</title>
    <link rel="stylesheet" href="style.css">

    <!-- Load libraries first -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <header>
        <h1>Welcome to My Awesome Website</h1>
        <nav>
            <a href="#">Home</a>
            <a href="#">About</a>
            <a href="#">Charts</a>
            <a href="#">Contact</a>
        </nav>
    </header>

    <main>
        <section class="content">
            <h2>About This Website</h2>
            <p>This is a placeholder for the website content. Add your amazing text here!</p>
        </section>

        <section class="charts">
            <h2>Cool Vega Charts</h2>

            <section class="chart-section">
                <h3>Fruit Retail Prices</h3>
                <div id="vega-chart-1"></div>
            </section>

            <section class="chart-section">
                <h3>Fruit Nutritional Information (Vitamin C)</h3>
                <div id="vega-chart-2"></div>
            </section>

        </section>
    </main>

    <footer>
        <p>&copy; 2024 My Cool Website</p>
    </footer>

    <script>
        async function fetchCSV(url) {
            const response = await fetch(url);
            const text = await response.text();
            return d3.csvParse(text);
        }

        const chart1Spec = {
            $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
            description: 'Retail Price of Fruits.',
            mark: 'bar',
            encoding: {
                x: { field: 'Fruit', type: 'nominal' },
                y: { field: 'RetailPrice', type: 'quantitative', format: '$0.2f' }
            }
        };

        const chart2Spec = {
  $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
  description: 'Nutritional Information of Fruits',
  transform: [
    {
      // Convert wide format (vitamin_c, fiber, potassium columns)
      // into a long format (Nutrient, Value) for grouped bars
      fold: ['vitamin_c', 'fiber', 'potassium'],
      as: ['Nutrient', 'Value']
    }
  ],
  mark: 'bar',
  encoding: {
    x: { field: 'Fruit', type: 'nominal', axis: { title: 'Fruit' } },
    y: { field: 'Value', type: 'quantitative', axis: { title: 'Amount' } },
    color: { field: 'Nutrient', type: 'nominal', title: 'Nutrient' },
    column: { field: 'Nutrient', type: 'nominal', spacing: 10 },
    tooltip: [
      { field: 'Fruit', type: 'nominal', title: 'Fruit' },
      { field: 'Nutrient', type: 'nominal', title: 'Nutrient' },
      { field: 'Value', type: 'quantitative', title: 'Value' }
    ]
  },
  config: {
    view: { stroke: 'transparent' },
    axis: { labelFontSize: 12, titleFontSize: 13 }
  }
};


        async function embedCharts() {
            try {
                const data1 = await fetchCSV('data1.csv');
                const data2 = await fetchCSV('data2.csv');

                chart1Spec.data = { values: data1 };
                chart2Spec.data = { values: data2 };

                await vegaEmbed('#vega-chart-1', chart1Spec);
                await vegaEmbed('#vega-chart-2', chart2Spec);
            } catch (err) {
                console.error('Error embedding charts:', err);
            }
        }

        embedCharts();
    </script>
</body>
</html>
