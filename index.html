<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Cool Website with Vega Charts</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
    <header>
        <h1>Welcome to My Awesome Website</h1>
        <nav>
            <a href="#">Home</a>
            <a href="#">About</a>
            <a href="#">Charts</a>
            <a href="#">Contact</a>
        </nav>
    </header>

    <main>
        <section class="content">
            <h2>About This Website</h2>
            <p>This is a placeholder for the website content. Add your amazing text here!</p>
        </section>

        <section class="charts">
            <h2>Cool Vega Charts</h2>
            <div id="vega-chart-1"></div>
            <div id="vega-chart-2"></div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 My Cool Website</p>
    </footer>

    <script>
        // Function to fetch CSV data (replace with a real implementation)
        async function fetchCSV(url) {
            const response = await fetch(url);
            const text = await response.text();
            return d3.csvParse(text);
        }

        // Vega-Lite specifications
        const chart1Spec = {
            $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
            description: 'Retail Price of Fruits.',
            data: { url: 'data1.csv' },
            mark: 'bar',
            encoding: {
                x: {field: 'Fruit', type: 'nominal'},
                y: {field: 'RetailPrice', type: 'quantitative', format: '$0.2f'}
            }
        };

        const chart2Spec = {
          $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
          description: 'Nutritional Information of Fruits',
          data: { url: 'data2.csv' },
          mark: 'arc',
          encoding: {
            theta: {field: 'vitamin_c', type: 'quantitative', stack: true},
            color: {field: 'Fruit', type: 'nominal'},
            tooltip: [
              {field: 'Fruit', type: 'nominal', title: 'Fruit'},
              {field: 'vitamin_c', type: 'quantitative', title: 'Vitamin C', format: '0.0f mg'},
              {field: 'fiber', type: 'quantitative', title: 'Fiber', format: '0.1f g'},
              {field: 'potassium', type: 'quantitative', title: 'Potassium', format: '0.0f mg'}
            ]
          }
        };

        // Embed the charts
        async function embedCharts() {
            // Load data
            const data1 = await fetchCSV('data1.csv');
            const data2 = await fetchCSV('data2.csv');

            console.log('data2:', data2);
            // Update chart specifications with data
            chart1Spec.data.values = data1;
            chart2Spec.data.values = data2;

            console.log('chart2Spec:', chart2Spec);

            // Debugging - check data values
            if (data2 && data2.length > 0) {
                console.log('First fruit:', data2[0.Fruit);
                console.log('Vitamin C:', data2[0].vitamin_c);
                console.log('Fiber:', data2[0].fiber);
                console.log('Potassium:', data2[0].potassium);
            }

            // Embed the charts
            vegaEmbed('#vega-chart-1', chart1Spec);
            try {
                vegaEmbed('#vega-chart-2', chart2Spec);
            } catch (error) {
                console.error('Error embedding chart2:', error);
            }
        }

        embedCharts();

    </script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</body>
</html>
